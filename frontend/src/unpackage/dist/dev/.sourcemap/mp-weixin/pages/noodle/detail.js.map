{"version":3,"sources":["webpack:///C:/myprojects2/MeetingChangAn/pages/noodle/detail.vue?09f5","uni-app:///main.js","webpack:///C:/myprojects2/MeetingChangAn/pages/noodle/detail.vue?916c","webpack:///C:/myprojects2/MeetingChangAn/pages/noodle/detail.vue?8551","webpack:///C:/myprojects2/MeetingChangAn/pages/noodle/detail.vue?1b03","webpack:///C:/myprojects2/MeetingChangAn/pages/noodle/detail.vue?59a7","uni-app:///pages/noodle/detail.vue","webpack:///C:/myprojects2/MeetingChangAn/pages/noodle/detail.vue?d3c3"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","getFoodsByCity","getFoodsByCityAndTag","doWxLoginAndSave","addCheckin","key","data","cityId","cityInfo","name","tagline","noodles","pairings","seasonalFoods","posts","draftImages","draftCaption","draftLocation","showPostDialog","draftLongitude","draftLatitude","computed","cityHero","xian","baoji","xianyang","weinan","yanan","yulin","hanzhong","ankang","shangluo","tongchuan","onLoad","uni","title","methods","exists","rankMianshi","getCityNoodles","slug","intro","tags","img","fetchCityFoods","api","then","id","foodName","catch","console","getPairings","desc","getSeasonalFoods","badge","pickImages","count","sizeType","sourceType","success","previewDraft","current","urls","removeDraftImage","submitPost","caption","icon","token","info","longitude","latitude","type","fail","pos","locationName","imagePaths","content","now","createdAt","imgs","location","city","previewPost","chooseLocation","storageKey","savePostsToStorage","loadPostsFromStorage","removePost","goNoodle","url","openPostDialog","closePostDialog","locateWithAMap","myAmapFun","formatTime"],"mappings":";;;;;;;;;AAAA;AACA,OAAO,KAAU,EAAE,kBAKd;;;;;;;;;;;;;;;;ACNL;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+H;AAC/H;AAC0D;AACL;AACsC;;;AAG3F;AAC6L;AAC7L,gBAAgB,uMAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,6FAAM;AACR,EAAE,sGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,iGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC5BA;AAAA;AAAA;AAAA;AAAquB,CAAgB,kvBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC6GzvB;EAAAC;EAAAC;AACA;EAAAC;AACA;EAAAC;AACA;AACA;AACA,eAAe,mBAAO,CAAC,gCAAwB;AAC/C;EACAC;AACA;AAAA,eACA;EACAC;IACA;MACAC;MACAC;QAAAC;QAAAC;MAAA;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;MACA;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACA;MACA;IACA;EACA;EACAC;IACA;IACA;MACAV;QAAAd;QAAAC;MAAA;MACAsB;QAAAvB;QAAAC;MAAA;MACAc;QAAAf;QAAAC;MAAA;MACAe;QAAAhB;QAAAC;MAAA;MACAgB;QAAAjB;QAAAC;MAAA;MACAiB;QAAAlB;QAAAC;MAAA;MACAkB;QAAAnB;QAAAC;MAAA;MACAmB;QAAApB;QAAAC;MAAA;MACAoB;QAAArB;QAAAC;MAAA;MACAqB;QAAAtB;QAAAC;MAAA;IACA;IACA;MAAAD;MAAAC;IAAA;IACA;IACA;IACA;IACA;IACA;IACAwB;MAAAC;IAAA;IACA;IACA;EACA;EACAC;IACA;IACAC;MAAA;IAAA;IAEA;IACAC;MACA;QACA;UAAA;YAAA;UAAA;QAAA;QACA;UACA;UACA;UACA;UACA;QACA;MACA;QACA;MACA;IACA;IAEAC;MACA;MACA;QAAA;MAAA;MACA;QACAhB,OACA;UAAAiB;UAAA/B;UAAAgC;UAAAC;UAAAC;QAAA;MAEA;MACA;IACA;IAEA;IACAC;MAAA;QAAA;MACA;MACA;MACAC,mBACAC;QACA;QACA;QACA;UACA;UACA;UACA;UACA;UACA;YACAJ;UACA;YACA;cACAA;YACA;cACAA;YACA;UACA;UACA;YACA;YACAF;YACAO;YACAC;YACAvC;YACAgC;YACAC;YACAC;UACA;QACA;QACA;MACA,GACAM;QACAC;QACA;MACA;IACA;IACA;IACAC;MACA;QACA5B,OACA;UAAAlB;UAAA8B;UAAAiB;QAAA,GACA;UAAA/C;UAAA8B;UAAAiB;QAAA,EACA;QACApB,YACA;UAAA3B;UAAA8B;UAAAiB;QAAA,GACA;UAAA/C;UAAA8B;UAAAiB;QAAA,EACA;QACA5B,QACA;UAAAnB;UAAA8B;UAAAiB;QAAA,GACA;UAAA/C;UAAA8B;UAAAiB;QAAA,EACA;QACA3B,WACA;UAAApB;UAAA8B;UAAAiB;QAAA,GACA;UAAA/C;UAAA8B;UAAAiB;QAAA,EACA;QACA1B,SACA;UAAArB;UAAA8B;UAAAiB;QAAA,GACA;UAAA/C;UAAA8B;UAAAiB;QAAA,EACA;QACAzB,QACA;UAAAtB;UAAA8B;UAAAiB;QAAA,GACA;UAAA/C;UAAA8B;UAAAiB;QAAA,EACA;QACAxB,QACA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","file":"pages/noodle/detail.js","sourcesContent":["// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1764521018956\n      var cssReload = require(\"C:/HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/noodle/detail.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./detail.vue?vue&type=template&id=51485ee8&scoped=true&\"\nvar renderjs\nimport script from \"./detail.vue?vue&type=script&lang=js&\"\nexport * from \"./detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./detail.vue?vue&type=style&index=0&id=51485ee8&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"51485ee8\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/noodle/detail.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=template&id=51485ee8&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.showPostDialog ? _vm.draftImages.length : null\n  var l1 = _vm.__map(_vm.posts, function (it, idx) {\n    var $orig = _vm.__get_orig(it)\n    var l0 = it.imgs.slice(0, 3)\n    var m0 = _vm.formatTime(it.createdAt)\n    return {\n      $orig: $orig,\n      l0: l0,\n      m0: m0,\n    }\n  })\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        l1: l1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"city-page\">\r\n\r\n\r\n    <!-- 顶部城市头图：满屏宽，展示上端，超出裁掉下端 -->\r\n    <view class=\"hero\">\r\n      <image :src=\"cityHero\" class=\"hero-img\" />\r\n    </view>\r\n\r\n    <view class=\"section-title\">特色美食</view>\r\n    <view class=\"noodle-list\">\r\n      <view v-for=\"item in noodles\" :key=\"item.slug\" class=\"noodle-card\" @tap=\"goNoodle(item)\">\r\n        <image :src=\"item.img\" class=\"noodle-img\" mode=\"aspectFill\" />\r\n        <view class=\"noodle-body\">\r\n          <text class=\"noodle-name\">{{ item.name }}</text>\r\n\r\n          <view class=\"noodle-tags\">\r\n            <text v-for=\"t in item.tags\" :key=\"t\" class=\"tag\">#{{ t }}</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 经典与时令两列并排 -->\r\n    <view class=\"extra-sections\">\r\n      <view class=\"col\">\r\n        <view class=\"section-title\">经典美食组合</view>\r\n        <view class=\"pair-list\">\r\n          <view v-for=\"p in pairings\" :key=\"p.key\" class=\"pair-card\">\r\n            <view class=\"pair-body\">\r\n              <text class=\"pair-title\">{{ p.title }}</text>\r\n              <text class=\"pair-desc\">{{ p.desc }}</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      <view class=\"col\">\r\n        <view class=\"section-title\">时令与民俗美食</view>\r\n        <view class=\"season-list\">\r\n          <view v-for=\"s in seasonalFoods\" :key=\"s.key\" class=\"season-card\">\r\n            <view class=\"season-badge\">{{ s.badge }}</view>\r\n            <text class=\"season-desc\">{{ s.desc }}</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 美食打卡 -->\r\n    <view class=\"section-title section-title--with-action\">\r\n      <text>美食打卡</text>\r\n      <text class=\"section-action\" @tap=\"openPostDialog\">发布</text>\r\n    </view>\r\n\r\n    <!-- 发布弹窗（小窗口） -->\r\n    <view v-if=\"showPostDialog\" class=\"modal-mask\" @tap=\"closePostDialog\">\r\n      <view class=\"modal\" @tap.stop>\r\n        <view class=\"modal-title\">发布美食打卡</view>\r\n        <view class=\"upload-form\">\r\n          <view class=\"uploader\">\r\n            <view class=\"thumb\" v-for=\"(img, i) in draftImages\" :key=\"img\">\r\n              <image :src=\"img\" mode=\"aspectFill\" @tap=\"previewDraft(i)\" />\r\n              <text class=\"thumb-del\" @tap=\"removeDraftImage(i)\">×</text>\r\n            </view>\r\n            <view class=\"thumb add\" v-if=\"draftImages.length < 3\" @tap=\"pickImages\">\r\n              <text class=\"add-plus\">+</text>\r\n              <text class=\"add-text\">添加图片</text>\r\n            </view>\r\n          </view>\r\n\r\n          <view class=\"form-fields\">\r\n            <input class=\"input\" type=\"text\" v-model=\"draftCaption\" placeholder=\"写一句美食感受（必填）\" />\r\n            <input class=\"input\" type=\"text\" v-model=\"draftLocation\" placeholder=\"位置/店名（可选）\" />\r\n            <button class=\"post-btn\" type=\"default\" size=\"mini\" @tap=\"chooseLocation\">选择位置</button>\r\n            <button class=\"post-btn\" type=\"default\" size=\"mini\" @tap=\"locateWithAMap\">用高德定位</button>\r\n          </view>\r\n\r\n          <view class=\"form-actions\">\r\n            <button class=\"post-btn\" type=\"primary\" size=\"mini\" @tap=\"submitPost\">发布</button>\r\n            <button class=\"post-btn\" type=\"default\" size=\"mini\" @tap=\"closePostDialog\">取消</button>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 已发布打卡列表（全局，整行卡片，最多三图等分） -->\r\n    <view class=\"post-list\">\r\n      <view v-for=\"(it, idx) in posts\" :key=\"it.id\" class=\"post-card\">\r\n        <view class=\"post-images-row\">\r\n          <image\r\n            v-for=\"(img, i) in it.imgs.slice(0,3)\"\r\n            :key=\"img\"\r\n            :src=\"img\"\r\n            class=\"post-img-tn\"\r\n            mode=\"aspectFill\"\r\n            @tap=\"previewPost(it, i)\"\r\n          />\r\n        </view>\r\n        <text class=\"post-caption\">{{ it.caption || '暂无文案' }}</text>\r\n        <view class=\"post-meta\">\r\n          <text class=\"post-location\" v-if=\"it.location\">{{ it.location }}</text>\r\n          <text class=\"post-time\">{{ formatTime(it.createdAt) }}</text>\r\n        </view>\r\n        <text class=\"post-del\" @tap=\"removePost(idx)\">删除</text>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nconst { getFoodsByCity, getFoodsByCityAndTag } = require('../../api/foods');\r\nconst { doWxLoginAndSave } = require('../../api/user');\r\nconst { addCheckin } = require('../../api/checkin');\r\n// 引入高德小程序 SDK（需先 npm install @amap/amap-wx 并构建 npm）\r\n// 注意：把下面的 Key 替换为你的「微信小程序」类型的高德 Key\r\nvar amapFile = require('../../utils/amap-wx.js');\r\nvar myAmapFun = new amapFile.AMapWX({\r\n  key: 'c1aa30397cfa389d36803935266398ad'\r\n});\r\nexport default {\r\n  data() {\r\n    return {\r\n      cityId: '',\r\n      cityInfo: { name: '', tagline: '' },\r\n      noodles: [],\r\n      pairings: [],\r\n      seasonalFoods: [],\r\n      posts: [],\r\n      // 打卡上传草稿\r\n      draftImages: [],\r\n      draftCaption: '',\r\n      draftLocation: '',\r\n      showPostDialog: false,\r\n      draftLongitude: null,\r\n      draftLatitude: null\r\n    }\r\n  },\r\n  computed: {\r\n    cityHero() {\r\n      // 城市头图：已配置本地图（西安、宝鸡、咸阳、渭南、延安、榆林、汉中、安康、商洛、铜川），其他使用占位\r\n      const heroMap = {\r\n        xian: '/static/assets/xian.jpg',\r\n        baoji: '/static/assets/baoji.jpg',\r\n        xianyang: '/static/assets/xianyang.jpg',\r\n        weinan: '/static/assets/weinan.jpg',\r\n        yanan: '/static/assets/yanan.jpg',\r\n        yulin: '/static/assets/retouch_2025112420283592.jpg',\r\n        hanzhong: '/static/assets/hanzhong.jpg',\r\n        ankang: '/static/assets/ankang.jpg',\r\n        shangluo: '/static/assets/shangluo.jpg',\r\n        tongchuan: '/static/assets/tongchuan.jpg'\r\n      }\r\n      const defaultHero = '/static/assets/retouch_2025111814274381.png'\r\n      return heroMap[this.cityId] || defaultHero\r\n    }\r\n  },\r\n  onLoad(query) {\r\n    this.cityId = (query.city || '').trim()\r\n    const cityMap = {\r\n      xian:    { name: '西安',    tagline: '长安城下的万面同煮' },\r\n      tongchuan:{ name: '铜川',  tagline: '耀州臊子浇满铜魂' },\r\n      baoji:   { name: '宝鸡',   tagline: '臊子酸辣，擀面皮筋爽' },\r\n      xianyang:{ name: '咸阳',   tagline: '泾渭河畔的豪放拉面' },\r\n      weinan:  { name: '渭南',   tagline: '黄河东岸的宽与细' },\r\n      yanan:   { name: '延安',   tagline: '黄土地上的烈烈辣香' },\r\n      yulin:   { name: '榆林',   tagline: '因地处农牧交错带，榆林美食融合了陕北农耕的质朴与草原游牧的豪放，面食多用荞麦、杂粮，肉食以羊、驴为特色，体现了黄土高原人民的饮食智慧。' },\r\n      hanzhong:{ name: '汉中',   tagline: '巴山背篓里的米皮香' },\r\n      ankang:  { name: '安康',   tagline: '秦巴山里蒸出的湿润口感' },\r\n      shangluo:{ name: '商洛',   tagline: '秦岭南麓的山泉酸爽' },\r\n    }\r\n    this.cityInfo = cityMap[this.cityId] || { name: '陕西', tagline: '三秦大地面香长' }\r\n    // 通过接口按城市加载美食，替换原本的静态数据\r\n    this.fetchCityFoods()\r\n    this.pairings = this.getPairings(this.cityId)\r\n    this.seasonalFoods = this.getSeasonalFoods(this.cityId)\r\n    // 设置顶部导航标题为城市名\r\n    uni.setNavigationBarTitle({ title: this.cityInfo.name })\r\n    // 加载本地持久化的打卡\r\n    this.loadPostsFromStorage()\r\n  },\r\n  methods: {\r\n    // 简单存在性判断：H5/小程序无法直接读文件，这里用约定占位，若需要严格判断可改为服务器地址或维护清单\r\n    exists(_path) { return false },\r\n\r\n    // 排序：含“面食”标签的优先\r\n    rankMianshi(list) {\r\n      try {\r\n        const hasMianshi = (tags) => Array.isArray(tags) && tags.some(t => String(t).includes('面食'))\r\n        return [...list].sort((a, b) => {\r\n          const A = hasMianshi(a.tags)\r\n          const B = hasMianshi(b.tags)\r\n          if (A === B) return 0\r\n          return A ? -1 : 1\r\n        })\r\n      } catch (e) {\r\n        return list\r\n      }\r\n    },\r\n\r\n    getCityNoodles(id) {\r\n      // 保留静态数据作为后备（接口失败时兜底）\r\n      const img = (slug) => `/static/assets/retouch_2025112414392946.png`\r\n      const data = {\r\n        xian: [\r\n          { slug: 'biangbiang', name: 'biángbiáng面', intro: '宽厚能兜住蒜泥与醋香，豪迈又筋道。', tags: ['宽面','油泼','陕味'], img: img('biangbiang') },\r\n        ]\r\n      }\r\n      return data[id] || []\r\n    },\r\n\r\n    // 通过接口获取城市美食（可选 tag 过滤）\r\n    fetchCityFoods(tag) {\r\n      const cityName = this.cityInfo?.name || ''\r\n      const api = tag ? getFoodsByCityAndTag : getFoodsByCity\r\n      api(cityName, tag)\r\n        .then(res => {\r\n          // 后端可能返回 {data:[]} 或直接 []\r\n          const list = Array.isArray(res) ? res : (res.data || [])\r\n          this.noodles = list.map(it => {\r\n            const name = it.foodName || it.name\r\n            const intro = it.introduction || it.intro || it.description || ''\r\n            const img = it.imageUrl || it.img || '/static/assets/retouch_2025112414392946.png'\r\n            let tags = []\r\n            if (Array.isArray(it.tags)) {\r\n              tags = it.tags\r\n            } else if (it.tag != null) {\r\n              if (typeof it.tag === 'string') {\r\n                tags = it.tag.split(/[,\\s]+/).filter(Boolean)\r\n              } else {\r\n                tags = [it.tag]\r\n              }\r\n            }\r\n            return {\r\n              // 规范字段名，确保页面渲染正常（slug 优先用 id 或名称）\r\n              slug: it.slug || it.id || name,\r\n              id: it.id,\r\n              foodName: it.foodName || name,\r\n              name,\r\n              intro,\r\n              tags,\r\n              img\r\n            }\r\n          })\r\n          this.noodles = this.rankMianshi(this.noodles)\r\n        })\r\n        .catch(err => {\r\n          console.warn('按城市获取美食失败，使用本地兜底：', err)\r\n          this.noodles = this.rankMianshi(this.getCityNoodles(this.cityId))\r\n        })\r\n    },\r\n    // 经典美食组合：不同城市返回不同的本地经典搭配（纯文字）\r\n    getPairings(id) {\r\n      const map = {\r\n        xian: [\r\n          { key: 'xa-1', title: 'biángbiáng面 + 糖蒜', desc: '宽面兜汁，配上微甜酸的糖蒜，咸甜平衡更开胃。' },\r\n          { key: 'xa-2', title: '肉夹馍 + 豆皮/凉皮', desc: '酥脆馍与清爽凉皮同食，层次丰富不腻口。' }\r\n        ],\r\n        tongchuan: [\r\n          { key: 'tc-1', title: '耀州臊子面 + 豆腐脑', desc: '酸辣臊子配软嫩豆腐脑，冷热互补很下饭。' },\r\n          { key: 'tc-2', title: '油泼面 + 耀州小菜', desc: '热油泼辣子与当地咸香小菜搭配，香辣更过瘾。' }\r\n        ],\r\n        baoji: [\r\n          { key: 'bj-1', title: '岐山臊子面 + 醪糟蛋', desc: '酸辣咸香的臊子面配甜香醪糟，冷热搭配层次足。' },\r\n          { key: 'bj-2', title: '擀面皮 + 油泼辣子', desc: '筋爽擀面皮拌一勺油泼辣子，香辣更提味。' }\r\n        ],\r\n        xianyang: [\r\n          { key: 'xy-1', title: '扯面 + 凉拌菜', desc: '宽长扯面配爽口凉菜，解腻清口，夏季尤佳。' },\r\n          { key: 'xy-2', title: '臊子面 + 荞面饸饹', desc: '酸辣臊子与饸饹筋道同桌，双面主食更满足。' }\r\n        ],\r\n        weinan: [\r\n          { key: 'wn-1', title: '潼关臊子面 + 陕西小酥肉', desc: '酸辣臊子面配上小酥肉，咸香与脆嫩相映。' },\r\n          { key: 'wn-2', title: '韩城羊肉饸饹 + 蒜醋小菜', desc: '饸饹筋道配酸香小菜，羊汤更不腻。' }\r\n        ],\r\n        yanan: [\r\n          { key: 'ya-1', title: '擀面皮 + 臊子/辣子', desc: '柔韧擀面皮加臊子或辣子，酸辣层次分明。' },\r\n          { key: 'ya-2', title: '油泼面 + 黄米馍馍', desc: '辣香油泼面与甜糯黄米馍馍形成反差。' }\r\n        ],\r\n        yulin: [\r\n          { key: 'yl-1', title: '荞面饸饹 + 芝麻油旋饼', desc: '饸饹酸辣劲道配饼酥脆，是榆林常见的早餐组合。' },\r\n          { key: 'yl-2', title: '羊肉面 + 陕北腌菜', desc: '浓郁羊汤面配酸辣腌菜，解腻提味更耐食。' }\r\n        ],\r\n        hanzhong: [\r\n          { key: 'hz-1', title: '热米皮 + 油泼辣子', desc: '热食更筋韧，拌上油泼辣子，香气直上。' },\r\n          { key: 'hz-2', title: '菜豆腐面 + 时蔬凉菜', desc: '清爽豆香与时蔬凉菜的清冽相得益彰。' }\r\n        ],\r\n        ankang: [\r\n          { key: 'ak-1', title: '蒸面 + 魔芋凉粉', desc: '湿润蒸面与清爽凉粉同桌，口感反差更有趣。' },\r\n          { key: 'ak-2', title: '安康面 + 豆香小食', desc: '清淡面食配豆香小食，营养均衡不腻。' }\r\n        ],\r\n        shangluo: [\r\n          { key: 'sl-1', title: '酸汤面 + 荠菜包子', desc: '山泉酸爽与草本清香结合，自然清冽。' },\r\n          { key: 'sl-2', title: '荞面 + 野菜凉拌', desc: '荞香朴实配山野清爽凉拌，清口更解腻。' }\r\n        ]\r\n      }\r\n      return map[id] || map['xian']\r\n    },\r\n    // 时令与民俗美食：按城市定制两条示例\r\n    getSeasonalFoods(id) {\r\n      const map = {\r\n        xian: [\r\n          { key: 'xa-s1', badge: '上巳/踏青', desc: '凉皮与粉浆饭，春日踏青的清爽选择。' },\r\n          { key: 'xa-s2', badge: '中秋', desc: '葫芦头与稠酒同桌，咸香与甜醇并存。' }\r\n        ],\r\n        tongchuan: [\r\n          { key: 'tc-s1', badge: '立夏', desc: '耀州臊子面清而不腻，夏令可口。' },\r\n          { key: 'tc-s2', badge: '寒露', desc: '热汤面配小菜，驱寒暖胃。' }\r\n        ],\r\n        baoji: [\r\n          { key: 'bj-s1', badge: '立冬', desc: '岐山臊子面更热更香，暖胃驱寒。' },\r\n          { key: 'bj-s2', badge: '腊八', desc: '杂粮粥与面食同桌，朴实温暖。' }\r\n        ],\r\n        xianyang: [\r\n          { key: 'xy-s1', badge: '霜降', desc: '扯面配暖油泼，霜寒初至也要热气腾腾。' },\r\n          { key: 'xy-s2', badge: '小满', desc: '清爽凉菜配面食，解暑清口。' }\r\n        ],\r\n        weinan: [\r\n          { key: 'wn-s1', badge: '处暑', desc: '潼关臊子面酸辣适中，暑气渐退更合口。' },\r\n          { key: 'wn-s2', badge: '寒衣节', desc: '清淡面食纪念祖先，温饱与敬意同在。' }\r\n        ],\r\n        yanan: [\r\n          { key: 'ya-s1', badge: '二月二', desc: '擀面皮与豆香小食，祈愿“龙抬头”兴旺。' },\r\n          { key: 'ya-s2', badge: '七月', desc: '臊子面加酸菜，夏日里也要酸辣开胃。' }\r\n        ],\r\n        yulin: [\r\n          { key: 'yl-s1', badge: '腊月', desc: '腊肉、驴肉、羊杂粉汤，寒冬里的热乎味。' },\r\n          { key: 'yl-s2', badge: '春社', desc: '荞面饸饹与旋饼，社日里朴实满足的味道。' }\r\n        ],\r\n        hanzhong: [\r\n          { key: 'hz-s1', badge: '谷雨', desc: '热米皮加新鲜辣子油，春雨润物更筋道。' },\r\n          { key: 'hz-s2', badge: '冬至', desc: '菜豆腐面温润清爽，适合一家共享。' }\r\n        ],\r\n        ankang: [\r\n          { key: 'ak-s1', badge: '端午', desc: '蒸面与粽子同桌，秦巴风味并陈。' },\r\n          { key: 'ak-s2', badge: '立秋', desc: '面食配山野凉拌，清冽解暑。' }\r\n        ],\r\n        shangluo: [\r\n          { key: 'sl-s1', badge: '寒露', desc: '酸汤面最清冽，山泉与粮香相融。' },\r\n          { key: 'sl-s2', badge: '清明', desc: '荠菜馅与清爽面食，草本清香应季。' }\r\n        ]\r\n      }\r\n      return map[id] || map['xian']\r\n    },\r\n    // 选择草稿图片（最多3张）\r\n    pickImages() {\r\n      const remain = 3 - this.draftImages.length\r\n      if (remain <= 0) return\r\n      uni.chooseImage({\r\n        count: remain,\r\n        sizeType: ['compressed'],\r\n        sourceType: ['album','camera'],\r\n        success: (res) => {\r\n          const paths = res.tempFilePaths || []\r\n          this.draftImages = this.draftImages.concat(paths).slice(0, 3)\r\n        }\r\n      })\r\n    },\r\n    // 预览草稿图片\r\n    previewDraft(index) {\r\n      uni.previewImage({\r\n        current: this.draftImages[index],\r\n        urls: this.draftImages\r\n      })\r\n    },\r\n    // 删除草稿图片\r\n    removeDraftImage(index) {\r\n      this.draftImages.splice(index, 1)\r\n    },\r\n    // 提交发布（调用后端打卡接口）\r\n    async submitPost() {\r\n      const caption = (this.draftCaption || '').trim()\r\n      if (!caption) {\r\n        uni.showToast({ title: '请填写一句美食感受', icon: 'none' })\r\n        return\r\n      }\r\n      if (this.draftImages.length === 0) {\r\n        uni.showToast({ title: '请至少添加一张图片', icon: 'none' })\r\n        return\r\n      }\r\n      try {\r\n        // 确保已登录（基于 token）\r\n        let token = ''\r\n        try { token = uni.getStorageSync('token') || '' } catch (_) { token = '' }\r\n        if (!token) {\r\n          const info = await doWxLoginAndSave()\r\n          token = info?.token || ''\r\n        }\r\n        if (!token) {\r\n          uni.showToast({ title: '登录失败，请重试', icon: 'none' })\r\n          return\r\n        }\r\n        let longitude = this.draftLongitude\r\n        let latitude = this.draftLatitude\r\n        if (longitude == null || latitude == null) {\r\n          const pos = await new Promise((resolve, reject) => {\r\n            uni.getLocation({\r\n              type: 'gcj02',\r\n              success: (res) => resolve({ longitude: res.longitude, latitude: res.latitude }),\r\n              fail: reject\r\n            })\r\n          })\r\n          longitude = pos.longitude\r\n          latitude = pos.latitude\r\n        }\r\n        const locationName = (this.draftLocation || this.cityInfo?.name || '').trim()\r\n        const imagePaths = [...this.draftImages]\r\n        await addCheckin({\r\n          locationName,\r\n          longitude,\r\n          latitude,\r\n          content: caption,\r\n          imagePaths\r\n        })\r\n        const now = Date.now()\r\n        this.posts.unshift({\r\n          id: now,\r\n          createdAt: now,\r\n          imgs: imagePaths,\r\n          caption,\r\n          location: locationName,\r\n          city: this.cityInfo?.name || ''\r\n        })\r\n        this.savePostsToStorage()\r\n        this.draftImages = []\r\n        this.draftCaption = ''\r\n        this.draftLocation = ''\r\n        this.draftLongitude = null\r\n        this.draftLatitude = null\r\n        this.showPostDialog = false\r\n        uni.showToast({ title: '发布成功', icon: 'success' })\r\n      } catch (e) {\r\n        console.error('[submitPost] failed:', e)\r\n        uni.showToast({ title: '发布失败，请稍后重试', icon: 'none' })\r\n      }\r\n    },\r\n    // 预览已发布图片\r\n    previewPost(item, index = 0) {\r\n      uni.previewImage({\r\n        current: item.imgs[index],\r\n        urls: item.imgs\r\n      })\r\n    },\r\n    // 选择位置（小程序可用，H5端可能不支持）\r\n    chooseLocation() {\r\n      if (!uni.chooseLocation) {\r\n        uni.showToast({ title: '当前端不支持地图选点，请手动输入', icon: 'none' })\r\n        return\r\n      }\r\n      uni.chooseLocation({\r\n        success: (res) => {\r\n          this.draftLocation = res.name || res.address || `${res.latitude},${res.longitude}`\r\n          this.draftLatitude = res.latitude\r\n          this.draftLongitude = res.longitude\r\n        },\r\n        fail: () => {\r\n          uni.showToast({ title: '选择位置已取消', icon: 'none' })\r\n        }\r\n      })\r\n    },\r\n    // 本地存储（全局显示所有用户与城市）\r\n    storageKey() {\r\n      return 'noodle_posts_all'\r\n    },\r\n    savePostsToStorage() {\r\n      try {\r\n        uni.setStorageSync(this.storageKey(), this.posts)\r\n      } catch (e) { /* ignore */ }\r\n    },\r\n    loadPostsFromStorage() {\r\n      try {\r\n        const list = uni.getStorageSync(this.storageKey())\r\n        if (Array.isArray(list)) this.posts = list\r\n      } catch (e) { /* ignore */ }\r\n    },\r\n    // 删除已发布\r\n    removePost(idx) {\r\n      this.posts.splice(idx, 1)\r\n      this.savePostsToStorage()\r\n    },\r\n    goNoodle(item) {\r\n      uni.navigateTo({\r\n        url: `/pages/noodle/item?slug=${item.slug}&city=${this.cityId}&id=${(item && item.id) != null ? item.id : ''}&foodName=${encodeURIComponent((item && (item.foodName || item.name)) || '')}`\r\n      })\r\n    },\r\n    openPostDialog() {\r\n      this.showPostDialog = true\r\n    },\r\n    closePostDialog() {\r\n      this.showPostDialog = false\r\n    },\r\n    // 使用高德 SDK 获取当前位置并逆地理解析\r\n    locateWithAMap() {\r\n      if (!myAmapFun) {\r\n        uni.showToast({ title: '定位不可用：SDK未就绪', icon: 'none' });\r\n        return;\r\n      }\r\n      try {\r\n        myAmapFun.getRegeo({\r\n          success: (data) => {\r\n            const item = Array.isArray(data) ? data[0] : data\r\n            const addr = item?.name || item?.desc || (item?.regeocodeData && item.regeocodeData.formatted_address) || ''\r\n            this.draftLocation = addr || item?.location || ''\r\n            uni.getLocation({\r\n              type: 'gcj02',\r\n              success: (pos) => {\r\n                this.draftLatitude = pos.latitude\r\n                this.draftLongitude = pos.longitude\r\n              }\r\n            })\r\n            uni.showToast({ title: '定位成功', icon: 'success' })\r\n          },\r\n          fail: (err) => {\r\n            console.warn('AMap getRegeo fail:', err)\r\n            uni.showToast({ title: '定位失败，请稍后重试', icon: 'none' })\r\n          }\r\n        })\r\n      } catch (e) {\r\n        console.error('AMap init/locate error:', e)\r\n        uni.showToast({ title: '定位不可用，请检查Key或npm构建', icon: 'none' })\r\n      }\r\n    },\r\n    formatTime(ts) {\r\n      try {\r\n        if (!ts) return ''\r\n        const d = new Date(ts)\r\n        const y = d.getFullYear()\r\n        const m = String(d.getMonth() + 1).padStart(2, '0')\r\n        const day = String(d.getDate()).padStart(2, '0')\r\n        const hh = String(d.getHours()).padStart(2, '0')\r\n        const mm = String(d.getMinutes()).padStart(2, '0')\r\n        return `${y}-${m}-${day} ${hh}:${mm}`\r\n      } catch (e) {\r\n        return ''\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.city-page {\r\n  min-height: 100vh;\r\n  background: linear-gradient(180deg,#fffaf1 0%, #fff5dc 100%);\r\n  color: #5a2c12;\r\n  padding-bottom: 40rpx;\r\n}\r\n.top-row {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 24rpx;\r\n  padding: 20rpx 24rpx 8rpx;\r\n}\r\n.hero-line {\r\n  width: 100%;\r\n  height: 2rpx;\r\n  background: #8c5c2a;\r\n  border-radius: 2rpx;\r\n}\r\n\r\n.hero {\r\n  position: relative;        /* 作为绝对定位图片的参照 */\r\n  width: 100%;               /* 占满页面内容宽度，避免 vw 溢出 */\r\n  height: 360rpx;            /* 头图显示高度，可按需调整 */\r\n  overflow: hidden;          /* 超出部分裁剪（主要裁掉下端） */\r\n  margin-top: 0;             /* 紧贴页面顶端 */\r\n}\r\n.hero-img {\r\n  position: absolute;     /* 覆盖容器 */\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;      /* 充满容器并裁切 */\r\n  object-position: top;   /* 从顶部对齐，裁掉底部 */\r\n  transform: none;        /* 移除下移，避免露出顶部背景 */\r\n  display: block;\r\n}\r\n.city-text {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n}\r\n.city-name {\r\n  font-size: 40rpx;\r\n  font-weight: 700;\r\n}\r\n.city-desc {\r\n  margin-top: 8rpx;\r\n  font-size: 26rpx;\r\n  color: #8c5c2a;\r\n}\r\n.section-title {\r\n  margin: 20rpx 24rpx 12rpx; /* 与特色面食卡片左边缘对齐 */\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n}\r\n.section-title--with-action {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n.section-action {\r\n  background: #ffd98a;\r\n  color: #7b2f00;\r\n  padding: 6rpx 16rpx;\r\n  border-radius: 999px;\r\n  font-size: 24rpx;\r\n}\r\n.noodle-list {\r\n  padding: 0 24rpx;\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr; /* 两列网格 */\r\n  gap: 12rpx; /* 更紧凑的间距 */\r\n}\r\n.noodle-card {\r\n  background: #fff5df;\r\n  border-radius: 20rpx;\r\n  box-shadow: 0 8rpx 16rpx rgba(0,0,0,0.08);\r\n  display: flex;                /* 纵向：上图下文 */\r\n  flex-direction: column;\r\n  padding: 12rpx;               /* 更紧凑的内边距 */\r\n}\r\n.noodle-img {\r\n  width: 100%;                  /* 两列卡片占满卡片宽度 */\r\n  height: 240rpx;               /* 拉长20rpx，展示更大 */\r\n  border-radius: 16rpx;\r\n  object-fit: cover;            /* 充满并裁切，视觉更好 */\r\n  display: block;\r\n}\r\n.noodle-body {\r\n  padding: 8rpx 4rpx 4rpx;      /* 适配纵向卡片 */\r\n  display: flex;                /* 垂直排列文本 */\r\n  flex-direction: column;\r\n  gap: 10rpx;                   /* 更紧凑的段间距 */\r\n  flex: 1;                      /* 撑满卡片剩余空间，便于把标签压到最底部 */\r\n}\r\n.noodle-name {\r\n  font-size: 28rpx;             /* 两列更紧凑的标题 */\r\n  font-weight: 700;\r\n  display: block;               /* 保证换行 */\r\n}\r\n\r\n.noodle-tags {\r\n  margin-top: auto;             /* 将标签推到底部 */\r\n  padding-top: 8rpx;            /* 与名字保持一点点间距 */\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 8rpx 12rpx;\r\n}\r\n.tag {\r\n  font-size: 22rpx;\r\n  color: #7b2f00;\r\n  background: #ffecc7;\r\n  padding: 6rpx 12rpx;\r\n  border-radius: 999px;\r\n}\r\n\r\n/* 经典组合 */\r\n.pair-list {\r\n  padding: 0; /* 交由外层 extra-sections 控制统一左右内边距 */\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16rpx;\r\n}\r\n.pair-card {\r\n  background: #fff5df;\r\n  border-radius: 24rpx;\r\n  box-shadow: 0 12rpx 24rpx rgba(0,0,0,0.08);\r\n  padding: 16rpx;\r\n}\r\n.pair-body {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8rpx;\r\n}\r\n.pair-title {\r\n  font-size: 30rpx;\r\n  font-weight: 700;\r\n}\r\n.pair-desc {\r\n  margin-top: 8rpx;\r\n  font-size: 26rpx;\r\n  color: #8c5c2a;\r\n}\r\n\r\n/* 时令民俗 */\r\n.season-list {\r\n  padding: 0; /* 交由外层 extra-sections 控制统一左右内边距 */\r\n  display: flex;\r\n  flex-direction: column; /* 每列纵向排列卡片 */\r\n  gap: 16rpx;\r\n}\r\n.season-card {\r\n  background: #fff5df;\r\n  border-radius: 24rpx;\r\n  box-shadow: 0 12rpx 24rpx rgba(0,0,0,0.08);\r\n  padding: 16rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12rpx;\r\n}\r\n.season-badge {\r\n  background: #ffd98a;\r\n  color: #7b2f00;\r\n  padding: 6rpx 12rpx;\r\n  border-radius: 999px;\r\n  font-size: 22rpx;\r\n  flex-shrink: 0;\r\n}\r\n.season-desc {\r\n  font-size: 26rpx;\r\n}\r\n\r\n/* 打卡区 - 上传表单 */\r\n.upload-form {\r\n  padding: 0 24rpx 12rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n}\r\n.modal-mask {\r\n  position: fixed;\r\n  left: 0; top: 0; right: 0; bottom: 0;\r\n  background: rgba(0,0,0,0.35);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 9999;\r\n}\r\n.modal {\r\n  width: 86%;\r\n  max-width: 640rpx;\r\n  background: #fff5df;\r\n  border-radius: 24rpx;\r\n  box-shadow: 0 16rpx 32rpx rgba(0,0,0,0.18);\r\n  overflow: hidden;\r\n}\r\n.modal-title {\r\n  padding: 16rpx 20rpx 0;\r\n  font-size: 30rpx;\r\n  font-weight: 700;\r\n  color: #7b2f00;\r\n}\r\n.uploader {\r\n  display: flex;\r\n  gap: 12rpx;\r\n  flex-wrap: wrap;\r\n}\r\n.thumb {\r\n  width: 160rpx;\r\n  height: 160rpx;\r\n  border-radius: 16rpx;\r\n  overflow: hidden;\r\n  position: relative;\r\n  background: #fff5df;\r\n  box-shadow: 0 8rpx 16rpx rgba(0,0,0,0.06);\r\n}\r\n.thumb image {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n.thumb-del {\r\n  position: absolute;\r\n  right: 8rpx;\r\n  top: 8rpx;\r\n  background: rgba(0,0,0,0.45);\r\n  color: #fff;\r\n  border-radius: 999px;\r\n  padding: 2rpx 10rpx;\r\n  font-size: 22rpx;\r\n}\r\n.thumb.add {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  color: #7b2f00;\r\n}\r\n.add-plus {\r\n  font-size: 40rpx;\r\n  line-height: 1;\r\n}\r\n.add-text {\r\n  font-size: 22rpx;\r\n}\r\n.form-fields {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10rpx;\r\n}\r\n.input {\r\n  background: #fff5df;\r\n  border-radius: 12rpx;\r\n  padding: 12rpx;\r\n  font-size: 26rpx;\r\n  box-shadow: inset 0 0 0 1rpx rgba(0,0,0,0.06);\r\n}\r\n.form-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n}\r\n.post-btn {\r\n  background: #ffc34a;\r\n  color: #5a2c12;\r\n  border-radius: 999px;\r\n  padding: 0 16rpx;\r\n}\r\n/* 两列容器：左经典、右时令 */\r\n.extra-sections {\r\n  padding: 0 24rpx; /* 统一左右内边距，确保与上方卡片左侧对齐 */\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr;\r\n  gap: 16rpx;\r\n}\r\n.col {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n}\r\n\r\n.post-list {\r\n  padding: 0 24rpx 16rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16rpx;\r\n}\r\n.post-card {\r\n  background: #fff5df;\r\n  border-radius: 20rpx;\r\n  box-shadow: 0 8rpx 18rpx rgba(0,0,0,0.08);\r\n  overflow: hidden;\r\n  padding: 10rpx 10rpx 12rpx;\r\n  position: relative;\r\n}\r\n.post-img {\r\n  width: 100%;\r\n  height: 220rpx;\r\n  object-fit: cover;\r\n  display: block;\r\n}\r\n.post-footer {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 6rpx 12rpx 8rpx;\r\n  font-size: 22rpx;\r\n  color: #8c5c2a;\r\n}\r\n.post-time {\r\n  opacity: 0.9;\r\n}\r\n.post-location {\r\n  opacity: 0.9;\r\n}\r\n.post-caption {\r\n  display: block;\r\n  padding: 10rpx 6rpx 6rpx;\r\n  font-size: 26rpx;\r\n}\r\n.post-del {\r\n  position: absolute;\r\n  right: 10rpx;\r\n  top: 10rpx;\r\n  background: rgba(0,0,0,0.35);\r\n  color: #fff;\r\n  border-radius: 999px;\r\n  padding: 2rpx 10rpx;\r\n  font-size: 22rpx;\r\n}\r\n/* 新增：三图等分与底部元信息布局 */\r\n.post-images-row {\r\n  display: grid;\r\n  grid-template-columns: repeat(3, 1fr);\r\n  gap: 6rpx;\r\n  width: 100%;\r\n}\r\n.post-img-tn {\r\n  width: 100%;\r\n  height: 200rpx;\r\n  object-fit: cover;\r\n  display: block;\r\n  border-radius: 10rpx;\r\n}\r\n.post-meta {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 6rpx;\r\n  font-size: 22rpx;\r\n  color: #8c5c2a;\r\n}\r\n</style>","import mod from \"-!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=style&index=0&id=51485ee8&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=style&index=0&id=51485ee8&scoped=true&lang=scss&\""],"sourceRoot":""}